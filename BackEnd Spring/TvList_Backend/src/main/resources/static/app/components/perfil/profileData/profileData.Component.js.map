{"version":3,"file":"profileData.Component.js","sourceRoot":"","sources":["profileData.Component.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAQA;gBAuBE,8BAAoB,gBAA4B,EAAS,GAAc,EAAS,EAAe;oBAA3E,qBAAgB,GAAhB,gBAAgB,CAAY;oBAAS,QAAG,GAAH,GAAG,CAAW;oBAAS,OAAE,GAAF,EAAE,CAAa;oBAdvF,WAAM,GAAC,CAAC,CAAC;oBACT,cAAS,GAAC,CAAC,CAAC;oBACZ,aAAQ,GAAC,CAAC,CAAC;oBAEX,iBAAY,GAAM,IAAI,gBAAI,EAAE,CAAC;oBAE7B,gBAAW,GAAS,KAAK,CAAC;oBAI1B,eAAU,GAAS,KAAK,CAAC;gBAIgE,CAAC;gBAElG,uCAAQ,GAAR;oBACE,iDAAiD;oBACjD,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC;wBACxB,QAAQ,EAAG,CAAC,EAAE,EAAC,mBAAU,CAAC,OAAO,CAAC,CAAC,mBAAU,CAAC,QAAQ,EAAC,mBAAU,CAAC,OAAO,CAAC,gEAAgE,CAAC,CAAC,CAAC,CAAC;wBAC9I,cAAc,EAAE,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC;4BAC5B,QAAQ,EAAE,CAAC,EAAE,EAAE,mBAAU,CAAC,OAAO,CAAC,CAAC,mBAAU,CAAC,QAAQ,EAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC,CAAC;4BACpF,WAAW,EAAE,CAAC,EAAE,EAAE,IAAI,CAAC;yBACxB,EAAC,EAAC,SAAS,EAAE,IAAI,CAAC,sBAAsB,EAAC,CAAC;qBAC5C,CAAC,CAAC;oBACH,IAAI,CAAC,eAAe,EAAE,CAAC;gBACzB,CAAC;gBAEO,yCAAU,GAAlB;oBAAA,iBAkCC;oBAhCC,IAAI,WAAW,CAAC;oBAChB,IAAI,CAAC,WAAW,GAAC,KAAK,CAAC;oBACrB,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA,CAAC;wBACb,IAAI,aAAa,GAAC,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;wBAC1D,aAAa,CAAC,QAAQ,GAAG,UAAC,IAAI,EAAE,MAAM,EAAE,OAAO;4BAC7C,EAAE,CAAC,CAAC,MAAM,IAAI,GAAG,CAAC,CAAA,CAAC;gCACjB,KAAI,CAAC,YAAY,CAAC,MAAM,GAAC,IAAI,CAAC;gCAC9B,OAAO,CAAC,KAAK,CAAC,wBAAwB,CAAC,CAAC;gCACxC,oBAAoB;gCACpB,WAAW,GAAC,KAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,KAAI,CAAC,YAAY,CAAC,CAAC;gCACjE,WAAW,CAAC,SAAS,CAAC,UAAA,CAAC;oCACrB,KAAI,CAAC,gBAAgB,CAAC,UAAU,GAAC,KAAI,CAAC,YAAY,CAAC;oCACnD,UAAU,CAAC,UAAC,CAAC;wCACX,KAAI,CAAC,WAAW,GAAC,IAAI,CAAC;oCACxB,CAAC,EAAC,CAAC,CAAC,CAAA;gCACN,CAAC,CAAC,CAAC;4BACL,CAAC;4BAAC,IAAI,CAAC,CAAC;gCACN,OAAO,CAAC,KAAK,CAAC,sBAAsB,CAAC,CAAC;4BACxC,CAAC;wBACH,CAAC,CAAC;wBACF,aAAa,CAAC,MAAM,EAAE,CAAC;oBACzB,CAAC;oBACD,IAAI,CACJ,CAAC;wBACC,WAAW,GAAC,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;wBACjE,WAAW,CAAC,SAAS,CAAC,UAAA,CAAC;4BACvB,KAAI,CAAC,gBAAgB,CAAC,UAAU,GAAC,KAAI,CAAC,YAAY,CAAC;4BACnD,UAAU,CAAC,UAAC,CAAC;gCACX,KAAI,CAAC,WAAW,GAAC,IAAI,CAAC;4BACxB,CAAC,EAAC,CAAC,CAAC,CAAA;wBACN,CAAC,CAAC,CAAC;oBACH,CAAC;gBACL,CAAC;gBAIO,8CAAe,GAAvB;oBACE,IAAI,CAAC,YAAY,GAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC,CAAC;oBAC/E,IAAI,CAAC,YAAY,CAAC,aAAa,GAAC,EAAE,CAAC;gBACrC,CAAC;gBAGO,oDAAqB,GAA7B,UAA8B,OAAgB;oBAC5C,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,IAAI,SAAS,CAAC,CAAC,CAAC;wBAC/B,IAAI,QAAQ,GAAC,CAAC,CAAC;wBACf,QAAQ,IAAE,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,GAAC,CAAC,CAAC,GAAC,CAAC,CAAC;wBACrC,QAAQ,GAAC,QAAQ,GAAC,CAAC,GAAC,CAAC,GAAC,QAAQ,CAAC;wBAC/B,QAAQ,IAAE,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,GAAC,CAAC,CAAC;wBACnC,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;4BAClC,QAAQ,IAAE,IAAI,CAAC;wBACjB,CAAC;wBACD,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;4BAClC,QAAQ,IAAE,GAAG,CAAC;wBAChB,CAAC;wBACD,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;4BAClC,QAAQ,IAAE,GAAG,CAAC;wBAChB,CAAC;wBAED,EAAE,CAAC,CAAC,QAAQ,GAAC,EAAE,CAAC,CAAA,CAAC;4BACf,MAAM,CAAC,EAAC,kBAAkB,EAAE,IAAI,EAAC,CAAC;wBACpC,CAAC;oBACH,CAAC;gBACH,CAAC;gBAGO,yCAAU,GAAlB,UAAmB,MAAM;oBACvB,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oBACnC,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CACd,CAAC;wBACC,IAAI,CAAC,UAAU,GAAC,IAAI,CAAC;wBACrB,IAAI,GAAG,GAAO,QAAQ,CAAC,cAAc,CAAC,QAAQ,CAAE,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;wBAClE,IAAI,MAAM,GAAI,IAAI,UAAU,EAAE,CAAC;wBAC/B,yCAAyC;wBACzC,IAAI,GAAG,GAAG,IAAI,KAAK,EAAE,CAAC;wBACtB,GAAG,CAAC,MAAM,GAAG;4BACX,wBAAwB;4BACxB,GAAG,CAAC,MAAM,CAAC,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC;4BAC7B,GAAG,CAAC,MAAM,CAAC,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC;4BAC/B,aAAa;4BACb,GAAG,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,EACjB,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,GAAG,CAAC,MAAM,CAAC,MAAM,CACxC,CAAC;wBACJ,CAAC,CAAA;wBACD,qCAAqC;wBACrC,MAAM,CAAC,SAAS,GAAG;4BACjB,GAAG,CAAC,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC;wBAC1B,CAAC,CAAA;wBACD,2BAA2B;wBAC3B,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oBAClC,CAAC;oBACD,IAAI,CAAA,CAAC;wBACH,IAAI,CAAC,UAAU,GAAC,KAAK,CAAC;oBACxB,CAAC;gBACH,CAAC;gBAEO,wCAAS,GAAjB,UAAkB,KAAK;oBACrB,IAAI,QAAQ,GAAC,CAAC,CAAC;oBACf,QAAQ,IAAE,CAAC,KAAK,CAAC,MAAM,GAAC,CAAC,CAAC,GAAC,CAAC,CAAC;oBAC7B,QAAQ,GAAC,QAAQ,GAAC,CAAC,GAAC,CAAC,GAAC,QAAQ,CAAC;oBAC/B,QAAQ,IAAE,CAAC,KAAK,CAAC,MAAM,CAAC,GAAC,CAAC,CAAC;oBAC3B,EAAE,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;wBAC1B,QAAQ,IAAE,IAAI,CAAC;oBACjB,CAAC;oBACD,EAAE,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;wBAC1B,QAAQ,IAAE,GAAG,CAAC;oBAChB,CAAC;oBACD,EAAE,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;wBAC1B,QAAQ,IAAE,GAAG,CAAC;oBAChB,CAAC;oBACD,QAAQ,GAAC,QAAQ,GAAC,GAAG,GAAC,GAAG,GAAC,QAAQ,CAAC;oBACnC,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC;gBAEnC,CAAC;gBAEO,gDAAiB,GAAzB,UAA0B,IAAW;oBACnC,IAAI,KAAK,GAAC,CAAC,CAAC;oBACZ,EAAE,CAAC,CAAC,IAAI,GAAC,EAAE,CAAC;wBACV,KAAK,GAAC,EAAE,CAAC;oBACX,IAAI;wBACF,KAAK,GAAG,IAAI,GAAC,EAAE,CAAC;oBAClB,IAAI,CAAC,MAAM,GAAC,KAAK,CAAC;oBAClB,IAAI,KAAK,GAAC,CAAC,CAAC;oBACZ,EAAE,CAAC,CAAC,IAAI,GAAC,EAAE,CAAC;wBACV,KAAK,GAAC,EAAE,CAAA;oBACV,IAAI;wBACF,KAAK,GAAG,CAAC,IAAI,GAAC,EAAE,CAAC,GAAC,EAAE,CAAC;oBACvB,KAAK,GAAE,KAAK,GAAC,CAAC,GAAC,CAAC,GAAC,KAAK,CAAC;oBACvB,IAAI,CAAC,SAAS,GAAC,KAAK,CAAC;oBACrB,IAAI,OAAO,GAAC,CAAC,CAAC;oBACd,OAAO,GAAG,IAAI,GAAC,EAAE,CAAC;oBAClB,OAAO,GAAE,OAAO,GAAC,CAAC,GAAC,CAAC,GAAC,OAAO,CAAC;oBAC7B,IAAI,CAAC,QAAQ,GAAC,OAAO,CAAC;gBACxB,CAAC;gBAGO,qDAAsB,GAA9B,UAA+B,OAAqB;oBAClD,EAAE,CAAC,CAAC,OAAO,CAAC,QAAQ,IAAI,SAAS,IAAI,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,KAAK,IAAI,SAAS,IAAI,OAAO,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,KAAK,IAAI,SAAS,CAAC;wBACzI,EAAE,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,KAAK,KAAK,OAAO,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,KAAM,CAAC;4BAChF,MAAM,CAAC,EAAC,gBAAgB,EAAC,IAAI,EAAC,CAAC;gBAErC,CAAC;gBAhLD;oBAAC,gBAAS,CAAC,eAAe,CAAC;;2EAAA;gBAC3B;oBAAC,gBAAS,CAAC,eAAe,CAAC;;2EAAA;gBAC3B;oBAAC,gBAAS,CAAC,YAAY,CAAC;;wEAAA;gBACxB;oBAAC,gBAAS,CAAC,YAAY,CAAC;;wEAAA;gBACxB;oBAAC,gBAAS,CAAC,YAAY,CAAC;;wEAAA;gBAX1B;oBAAC,gBAAS,CAAC;wBACT,WAAW,EAAE,+DAA+D;wBAC5E,SAAS,EAAE,CAAC,2DAA2D,CAAC;qBACzE,CAAC;;wCAAA;gBAsLF,2BAAC;YAAD,CAAC,AArLD,IAqLC;YArLD,uDAqLC,CAAA","sourcesContent":["import {Component,OnInit,ElementRef,ViewChild} from 'angular2/core';\r\nimport {userService} from '../../../components/user/user.service';\r\nimport {user} from '../../../components/user/user.data';\r\nimport {Control,Validators,FormBuilder,ControlGroup,FORM_DIRECTIVES} from 'angular2/common';\r\n@Component({\r\n  templateUrl: './app/components/perfil/profileData/profileData.Template.html',\r\n  styleUrls: ['./app/components/perfil/profileData/profileData.Style.css']\r\n})\r\nexport class profileDataComponent implements OnInit{\r\n\r\n\r\n  @ViewChild('regForm_Step1') regForm_Step1;\r\n  @ViewChild('regForm_Step2') regForm_Step2;\r\n  @ViewChild('link_Step1') link_Step1:ElementRef;\r\n  @ViewChild('link_Step2') link_Step2:ElementRef;\r\n  @ViewChild('link_Step3') link_Step3:ElementRef;\r\n\r\n  private redVal=0;\r\n  private yellowVal=0;\r\n  private greenVal=0;\r\n\r\n  private userToCreate:user=new user();\r\n\r\n  private succesLabel:boolean=false;\r\n\r\n  private file: File;\r\n\r\n  private imagenPrev:boolean=false;\r\n\r\n  form: ControlGroup;\r\n\r\n  constructor(private _servicioUsuario:userService,private ref:ElementRef,private fb: FormBuilder){}\r\n\r\n  ngOnInit():any {\r\n    // (<user>this._servicioUsuario.userLogged).name;\r\n    this.form = this.fb.group({\r\n      userMail : ['',Validators.compose([Validators.required,Validators.pattern(\"([a-z]|[A-Z]|[0-9]|_)+@([a-z]|[A-Z]|[0-9]|_)+\\\\.([a-z]|[A-Z])+\")])],\r\n      passwordsGroup: this.fb.group({\r\n        password: [\"\", Validators.compose([Validators.required,this.passwordStreValidator])],\r\n        passwordRep: [\"\", null]\r\n      },{validator: this.passwordRepetValidator})\r\n    });\r\n    this.loadProfileData();\r\n  }\r\n\r\n  private updateUser(){\r\n\r\n    let userCreated;\r\n    this.succesLabel=false;\r\n      if (this.file){\r\n        let multipartItem=this._servicioUsuario.upload(this.file);\r\n        multipartItem.callback = (data, status, headers) => {\r\n          if (status == 200){\r\n            this.userToCreate.avatar=data;\r\n            console.debug(\"File has been uploaded\");\r\n            //this.loadImages();\r\n            userCreated=this._servicioUsuario.setUserByID(this.userToCreate);\r\n            userCreated.subscribe(x=>{\r\n              this._servicioUsuario.userLogged=this.userToCreate;\r\n              setTimeout((a)=>{\r\n                this.succesLabel=true;\r\n              },0)\r\n            });\r\n          } else {\r\n            console.error(\"Error uploading file\");\r\n          }\r\n        };\r\n        multipartItem.upload();\r\n      }\r\n      else\r\n      {\r\n        userCreated=this._servicioUsuario.setUserByID(this.userToCreate);\r\n        userCreated.subscribe(x=>{\r\n        this._servicioUsuario.userLogged=this.userToCreate;\r\n        setTimeout((a)=>{\r\n          this.succesLabel=true;\r\n        },0)\r\n      });\r\n      }\r\n  }\r\n\r\n\r\n\r\n  private loadProfileData(){\r\n    this.userToCreate=JSON.parse(JSON.stringify(this._servicioUsuario.userLogged));\r\n    this.userToCreate.user_Password='';\r\n  }\r\n\r\n\r\n  private passwordStreValidator(control: Control): { [s: string]: boolean } {\r\n    if (control.value != undefined) {\r\n      let passStre=0;\r\n      passStre+=(control.value.length-6)*6;\r\n      passStre=passStre<0?0:passStre;\r\n      passStre+=(control.value.length)*4;\r\n      if (control.value.match(/[0-9]+/)) {\r\n        passStre*=1.25;\r\n      }\r\n      if (control.value.match(/[a-z]+/)) {\r\n        passStre*=1.5;\r\n      }\r\n      if (control.value.match(/[A-Z]+/)) {\r\n        passStre*=1.5;\r\n      }\r\n\r\n      if (passStre<50){\r\n        return {passwordStrenError: true};\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  private selectFile($event) {\r\n    this.file = $event.target.files[0];\r\n    if (this.file)\r\n    {\r\n      this.imagenPrev=true;\r\n      var ctx=(<any>document.getElementById('canvas')).getContext('2d');\r\n      var reader  = new FileReader();\r\n      // load to image to get it's width/height\r\n      var img = new Image();\r\n      img.onload = function() {\r\n        // scale canvas to image\r\n        ctx.canvas.width = img.width;\r\n        ctx.canvas.height = img.height;\r\n        // draw image\r\n        ctx.drawImage(img, 0, 0\r\n            , ctx.canvas.width, ctx.canvas.height\r\n        );\r\n      }\r\n      // this is to setup loading the image\r\n      reader.onloadend = function () {\r\n        img.src = reader.result;\r\n      }\r\n      // this is to read the file\r\n      reader.readAsDataURL(this.file);\r\n    }\r\n    else{\r\n      this.imagenPrev=false;\r\n    }\r\n  }\r\n\r\n  private UpdateBar(passw){\r\n    let passStre=0;\r\n    passStre+=(passw.length-6)*6;\r\n    passStre=passStre<0?0:passStre;\r\n    passStre+=(passw.length)*4;\r\n    if (passw.match(/[0-9]+/)) {\r\n      passStre*=1.25;\r\n    }\r\n    if (passw.match(/[a-z]+/)) {\r\n      passStre*=1.5;\r\n    }\r\n    if (passw.match(/[A-Z]+/)) {\r\n      passStre*=1.5;\r\n    }\r\n    passStre=passStre>100?100:passStre;\r\n    this.changePasswordBar(passStre);\r\n\r\n  }\r\n\r\n  private changePasswordBar(perc:number){\r\n    let redVa=0;\r\n    if (perc>49)\r\n      redVa=50;\r\n    else\r\n      redVa = perc%50;\r\n    this.redVal=redVa;\r\n    let yelVa=0;\r\n    if (perc>74)\r\n      yelVa=25\r\n    else\r\n      yelVa = (perc-50)%25;\r\n    yelVa =yelVa<0?0:yelVa;\r\n    this.yellowVal=yelVa;\r\n    let greenVa=0;\r\n    greenVa = perc-75;\r\n    greenVa =greenVa<0?0:greenVa;\r\n    this.greenVal=greenVa;\r\n  }\r\n\r\n\r\n  private passwordRepetValidator(control: ControlGroup): { [s: string]: boolean } {\r\n    if (control.controls != undefined && control.controls['password'].value != undefined && control.controls['passwordRep'].value != undefined)\r\n      if (control.controls['password'].value !== control.controls['passwordRep'].value )\r\n        return {passwordNotEqual:true};\r\n\r\n  }\r\n\r\n}\r\n"]}