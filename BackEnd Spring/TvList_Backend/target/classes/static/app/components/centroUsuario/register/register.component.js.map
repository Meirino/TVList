{"version":3,"file":"register.component.js","sourceRoot":"","sources":["register.component.ts"],"names":[],"mappings":"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","sourcesContent":["/**\r\n * Created by david on 18/04/2016.\r\n */\r\nimport {Component,ViewChild,ElementRef, OnInit} from 'angular2/core';\r\nimport {userService} from '../../user/user.service';\r\nimport {Observable,ConnectableObservable } from 'rxjs/Rx';\r\nimport {user} from '../../user/user.data';\r\n\r\n\r\nimport {Control,Validators,FormBuilder,ControlGroup,FORM_DIRECTIVES} from 'angular2/common';\r\n\r\n@Component({\r\n    directives: [FORM_DIRECTIVES],\r\n    selector:\"register\",\r\n    templateUrl: './app/components/centroUsuario/register/register.template.html',\r\n    styleUrls : ['./app/components/centroUsuario/register/register.style.css']\r\n})\r\n\r\nexport class registerComponent{\r\n\r\n    @ViewChild('regForm_Step1') regForm_Step1;\r\n    @ViewChild('regForm_Step2') regForm_Step2;\r\n    @ViewChild('link_Step1') link_Step1:ElementRef;\r\n    @ViewChild('link_Step2') link_Step2:ElementRef;\r\n    @ViewChild('link_Step3') link_Step3:ElementRef;\r\n    @ViewChild('imgPrev') imagePreview:ElementRef;\r\n\r\n    private userToCreate:user=new user();\r\n    private file: File;\r\n\r\n    private imagenPrev:boolean=false;\r\n\r\n    form: ControlGroup;\r\n\r\n    private currentStep = 1;\r\n    private showmessage=false;\r\n    private errors:string[]=[];\r\n\r\n    private redVal=0;\r\n    private yellowVal=0;\r\n    private greenVal=0;\r\n\r\n    constructor(private servicioUsuarios:userService,private ref:ElementRef,private fb: FormBuilder){\r\n    }\r\n    \r\n    \r\n    \r\n\r\n\r\n    ngOnInit() {\r\n        \r\n        this.form = this.fb.group({\r\n            passwordsGroup: this.fb.group({\r\n                password: [\"\", Validators.compose([Validators.required,this.passwordStreValidator])],\r\n                passwordRep: [\"\", null]\r\n            },{validator: this.passwordRepetValidator})\r\n        });\r\n\r\n    }\r\n\r\n    private reg_step1(){\r\n        this.showmessage=false;\r\n        let userAceptableStream=this.servicioUsuarios.checkIf_UserName_AND_Email_Free(this.userToCreate.user_Name,this.userToCreate.user_Email);\r\n        userAceptableStream.subscribe(\r\n            value => {\r\n                (<any>$(this.link_Step2.nativeElement)).tab('show');\r\n                this.currentStep=2;\r\n            },\r\n            error => {\r\n                this.showMessage(error);\r\n            }\r\n        );\r\n    }\r\n\r\n    private reg_step2(){\r\n        (<any>$(this.link_Step3.nativeElement)).tab('show');\r\n        this.currentStep=3;\r\n    }\r\n\r\n    private reg_step3(){\r\n        if (this.file){\r\n        let multipartItem=this.servicioUsuarios.upload(this.file);\r\n        multipartItem.callback = (data, status, headers) => {\r\n\r\n            if (status == 200){\r\n                this.userToCreate.avatar=data;\r\n                console.debug(\"File has been uploaded\");\r\n                //this.loadImages();\r\n                let userCreated=this.servicioUsuarios.createUser(this.userToCreate);\r\n            } else {\r\n                console.error(\"Error uploading file\");\r\n            }\r\n        };\r\n        multipartItem.upload();\r\n        }\r\n        else\r\n            this.servicioUsuarios.createUser(this.userToCreate);\r\n\r\n    }\r\n\r\n    private selectFile($event) {\r\n        this.file = $event.target.files[0];\r\n        if (this.file)\r\n        {\r\n        this.imagenPrev=true;\r\n        var ctx=(<any>document.getElementById('canvas')).getContext('2d');\r\n        var reader  = new FileReader();\r\n        // load to image to get it's width/height\r\n        var img = new Image();\r\n        img.onload = function() {\r\n            // scale canvas to image\r\n            ctx.canvas.width = img.width;\r\n            ctx.canvas.height = img.height;\r\n            // draw image\r\n            ctx.drawImage(img, 0, 0\r\n                , ctx.canvas.width, ctx.canvas.height\r\n            );\r\n        }\r\n        // this is to setup loading the image\r\n        reader.onloadend = function () {\r\n            img.src = reader.result;\r\n        }\r\n        // this is to read the file\r\n        reader.readAsDataURL(this.file);\r\n        }\r\n        else{\r\n            this.imagenPrev=false;\r\n        }\r\n    }\r\n    \r\n\r\n\r\n    private back(num:number){\r\n        switch(num){\r\n            case 1:\r\n                (<any>$(this.link_Step1.nativeElement)).tab('show');\r\n                break;\r\n            case 2:\r\n                (<any>$(this.link_Step2.nativeElement)).tab('show');\r\n        }\r\n        this.currentStep--;\r\n    }\r\n\r\n\r\n    \r\n    \r\n\r\n    private showMessage(mes:string[]){\r\n        this.errors=[];\r\n        if (mes[0].length!=0)\r\n            this.errors.push(mes[0]);\r\n        if (mes[1].length!=0)\r\n            this.errors.push(mes[1]);\r\n        setTimeout(() => {\r\n            this.showmessage=true;\r\n        }, 0);\r\n    }\r\n\r\n    private changePasswordBar(perc:number){\r\n        let redVa=0;\r\n        if (perc>49)\r\n            redVa=50;\r\n        else\r\n            redVa = perc%50;\r\n        this.redVal=redVa;\r\n        let yelVa=0;\r\n        if (perc>74)\r\n            yelVa=25\r\n        else\r\n            yelVa = (perc-50)%25;\r\n        yelVa =yelVa<0?0:yelVa;\r\n        this.yellowVal=yelVa;\r\n        let greenVa=0;\r\n        greenVa = perc-75;\r\n        greenVa =greenVa<0?0:greenVa;\r\n        this.greenVal=greenVa;\r\n    }\r\n\r\n    private UpdateBar(passw){\r\n        let passStre=0;\r\n        passStre+=(passw.length-6)*6;\r\n        passStre=passStre<0?0:passStre;\r\n        passStre+=(passw.length)*4;\r\n        if (passw.match(/[0-9]+/)) {\r\n            passStre*=1.25;\r\n        }\r\n        if (passw.match(/[a-z]+/)) {\r\n            passStre*=1.5;\r\n        }\r\n        if (passw.match(/[A-Z]+/)) {\r\n            passStre*=1.5;\r\n        }\r\n        passStre=passStre>100?100:passStre;\r\n        this.changePasswordBar(passStre);\r\n\r\n    }\r\n\r\n    private passwordStreValidator(control: Control): { [s: string]: boolean } {\r\n        if (control.value != undefined) {\r\n            let passStre=0;\r\n            passStre+=(control.value.length-6)*6;\r\n            passStre=passStre<0?0:passStre;\r\n            passStre+=(control.value.length)*4;\r\n            if (control.value.match(/[0-9]+/)) {\r\n                passStre*=1.25;\r\n            }\r\n            if (control.value.match(/[a-z]+/)) {\r\n                passStre*=1.5;\r\n            }\r\n            if (control.value.match(/[A-Z]+/)) {\r\n                passStre*=1.5;\r\n            }\r\n\r\n            if (passStre<50){\r\n                return {passwordStrenError: true};\r\n            }\r\n        }\r\n    }\r\n\r\n    private passwordRepetValidator(control: ControlGroup): { [s: string]: boolean } {\r\n    if (control.controls != undefined && control.controls['password'].value != undefined && control.controls['passwordRep'].value != undefined)\r\n        if (control.controls['password'].value !== control.controls['passwordRep'].value )\r\n            return {passwordNotEqual:true};\r\n\r\n    }\r\n}\r\n"]}